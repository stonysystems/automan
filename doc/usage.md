# How to use `automan`

`automan` expects to be invoked with two arguments, as in

    ./automan $SPEC_DIR $IMPL_DIR

where
- `$SPEC_DIR` is the path to the root of your existing Dafny specifications, and
- `$IMPL_DIR` is the desired path for the implementation files generated by `automan`

Each file `MySpec.i.dfy` within `$SPEC_DIR` (or some subdirectory thereof) that
you wish to translate should be accompanied by an automan annotation file
`MySpec.automan` in the same directory as `MySpec.i.dfy`. This will result in
`automan` generating `Impl_MySpec.i.dfy` within `$IMPL_DIR` (preserving
the subdirectory structure).

By default, `automan` will not overwrite already existing implementation files
in `$IMPL_DIR`. If you wish to regenerate some implementation files, use the
optional flag `--overwrite "File1 File2"` (note that this will not affect any of
the codependencies of the overwritten files).


## Annotation files

TODO Write this

## Module dependencies in translated specifications

Every implementation file `automan` generates will depend upon the specification
file that produced it, since this is required for the contracts `automan`
produces for functionalized predicates.

Let's say you have a specification file `Foo.i.dfy` that you wish for automan to
implement, and that it uses definitions from both `Bar.i.dfy` (which you've
directed `automan` to implement) and `Baz.i.dfy` (which you have **not**
directed `automan` to implement). Then, within `Foo_Impl.i.dfy`:

- the generated `Bar_Impl.i.dfy` and the original `Baz.i.dfy` will be imported;

- every use of a definition `BarDef` from `Bar.i.dfy` in the original `Foo` spec
  will be replaced by the `BarDef_Impl` generated by `automan` (found in
  `Bar_Impl.i.dfy` within `$IMPL_DIR`); and

- every use of a definition `BazDef` from `Baz.i.dfy` in the original `Foo` spec
  will be kept, with abstractify calls inserted as needed to mediate between the
  specification and implementation types
